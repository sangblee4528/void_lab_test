# Void Lab Test 진행 과정 보고서 (2026-01-12)

## 1. 개요
본 문서는 Windows 11 환경에서의 호환성 문제 해결과, MCP 의존성을 제거한 **"Truly Native (독자적 에이전트)"** 아키텍처로의 전환 과정을 기록합니다.

---

## 2. 주요 업데이트: Windows 11 호환성 및 독자적 에이전트 구축

### 2.1. Windows 11 UTF-8 인코딩 문제 해결
- **문제**: Windows 11 환경에서 파일 처리 시 시스템 기본 캐릭터셋(CP949)을 사용하여 한글 설정 파일이나 로그 로드 시 오류 발생.
- **해결**: 프로젝트 내 모든 `open()` 및 `logging.FileHandler` 호출부에 `encoding='utf-8'` 옵션을 명시적으로 추가하여 환경 변수 설정 없이도 안정적으로 동작하게 함.

### 2.2. "Truly Native" 아키텍처 도입 (`agent_native`)
- **기존 방식 (`agent_proxy`)**: LLM -> Proxy -> MCP Server -> DB로 이어지는 다단계 구조. MCP 프로토콜 오버헤드 존재.
- **새로운 방식 (`agent_native`)**: LLM -> Native Agent -> DB (Direct Access). 중간 브릿지인 MCP 서버 없이 파이썬 드라이버로 직접 DB에 접근하는 최적화된 구조.

---

## 3. 세부 구현 내역

### 3.1. 독자적 도구 라이브러리 구축 (`native_tools.py`)
- **내용**: 기존 MCP 서버에 흩어져 있던 도구 로직(문서 검색, 직원 정보 조회, 휴가 계산 등)을 `agent_native` 서버 내부로 통합.
- **기술**: `sqlite3` 파이썬 드라이버를 직접 사용하여 `mcp_data.db`에 쿼리를 수행하도록 구현.

### 3.2. 에이전트 엔진 최적화 (`agent_native_server.py`)
- **의존성 제거**: `McpSseClient` 및 MCP 서버와의 네트워크 통신 코드를 삭제하여 지연 시간(Latency) 단축.
- **로컬 실행**: LLM이 요청한 도구 호출을 서버 내부 메모리에 로드된 함수 매핑(`NATIVE_TOOL_REGISTRY`)을 통해 즉시 실행.

### 3.3. 통합 관리 및 검증 도구 업데이트
- **`manage_servers.py`**: MCP, Proxy 서버와 함께 Native 서버를 원클릭으로 구동할 수 있도록 관리 모듈 업데이트 (8001 포트 할당).
- **테스트 가이드**: `curl`을 이용한 직접적인 API 테스트 명령어 및 실행 절차를 문서화하여 배포.

---

## 4. 향후 계획
- `agent_native`의 성과를 바탕으로 기존 `agent_proxy`를 점진적으로 대체하거나, 특정 용도(외부 툴 연동 필요 시)에 따라 MCP 레이어를 선택적으로 사용하는 하이브리드 구조 검토.
- 도구 실행 시의 보안 검증 로직 강화.
